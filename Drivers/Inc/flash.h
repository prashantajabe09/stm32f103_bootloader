/*
 * flash.h
 *
 *  Created on: Jul 18, 2025
 *      Author: PRASHANT AJABE
 */

#ifndef INC_FLASH_H_
#define INC_FLASH_H_

#include "stm32f103x.h"

#define FLASH								FLASH_MEMORY_INTERFACE

#define FLASH_BASE_ADDR						0x08000000
#define FLASH_END_ADDR						0x0801FFFF

#define RDPRT_KEY							0x00A5

#define KEY_1								0x45670123
#define KEY_2   							0xCDEF89AB

#define OP_BYTE_BASE_ADDR		    		0x1FFFF800
#define OP_BYTE_DATA_REG_ADDR				0x1FFFF804
#define OP_BYTE_WRP_0_1_REG_ADDR    		0x1FFFF808
#define OP_BYTE_WRP_2_3_REG_ADDR			0x1FFFF80C

#define FLASH_MEMORY_WRITE_PROTECTED		1
#define FLASH_MEMORY_NOT_WRITE_PROTECTED	0

#define OP_BYTE_ERASE_FAILED  				1
#define OP_BYTE_ERASE_SUCCESS 				0

#define WRITE_SUCCESS 						1
#define WRITE_FAILED						0
#define FLASH_BUSY							1
#define FLASH_NOT_BUSY 						0
#define FLASH_ERASE_SUCCESS 2

#define OPTION_BYTE_ADDRESS					1
#define NOT_OPTION_BYTE_ADDRESS				0
typedef enum{
SECTOR_0 = 0,
SECTOR_1,
SECTOR_2,
SECTOR_3,
SECTOR_4,
SECTOR_5,
SECTOR_6,
SECTOR_7,
SECTOR_8,
SECTOR_9,
SECTOR_10,
SECTOR_11,
SECTOR_12,
SECTOR_13,
SECTOR_14,
SECTOR_15,
SECTOR_16,
SECTOR_17,
SECTOR_18,
SECTOR_19,
SECTOR_20,
SECTOR_31,
SECTOR_32,
SECTOR_33,
SECTOR_34,
SECTOR_35,
SECTOR_36,
SECTOR_37,
SECTOR_38,
SECTOR_39,
SECTOR_40,
SECTOR_41,
SECTOR_42,
SECTOR_43,
SECTOR_44,
SECTOR_45,
SECTOR_46,
SECTOR_47,
SECTOR_48,
SECTOR_49,
SECTOR_50,
SECTOR_51,
SECTOR_52,
SECTOR_53,
SECTOR_54,
SECTOR_55,
SECTOR_56,
SECTOR_57,
SECTOR_58,
SECTOR_59,
SECTOR_60,
SECTOR_61,
SECTOR_62,
SECTOR_63,
SECTOR_64,
SECTOR_65,
SECTOR_66,
SECTOR_67,
SECTOR_68,
SECTOR_69,
SECTOR_70,
SECTOR_71,
SECTOR_72,
SECTOR_73,
SECTOR_74,
SECTOR_75,
SECTOR_76,
SECTOR_77,
SECTOR_78,
SECTOR_79,
SECTOR_80,
SECTOR_81,
SECTOR_82,
SECTOR_83,
SECTOR_84,
SECTOR_85,
SECTOR_86,
SECTOR_87,
SECTOR_88,
SECTOR_89,
SECTOR_90,
SECTOR_91,
SECTOR_92,
SECTOR_93,
SECTOR_94,
SECTOR_95,
SECTOR_96,
SECTOR_97,
SECTOR_98,
SECTOR_99,
SECTOR_100,
SECTOR_101,
SECTOR_102,
SECTOR_103,
SECTOR_104,
SECTOR_105,
SECTOR_106,
SECTOR_107,
SECTOR_108,
SECTOR_109,
SECTOR_110,
SECTOR_111,
SECTOR_112,
SECTOR_113,
SECTOR_114,
SECTOR_115,
SECTOR_116,
SECTOR_117,
SECTOR_118,
SECTOR_119,
SECTOR_120,
SECTOR_121,
SECTOR_122,
SECTOR_123,
SECTOR_124,
SECTOR_125,
SECTOR_126,
SECTOR_127,
}sector_e;

extern uint32_t option_byte_info[4];

uint8_t flash_sector_erase(sector_e sector_no);
void flash_unlock(void);
void flash_lock(void);
uint8_t flash_mass_erase(void);
uint8_t flash_mem_write(uint16_t data, uint32_t address);
uint8_t is_flash_memory_write_protected(void);
void option_byte_read(void);
void op_byte_unlock(void);
uint8_t option_byte_erase(void);
void option_byte_write(uint32_t base_addr,uint8_t* p_data);
#endif /* INC_FLASH_H_ */
